/*
 Chen, Yi-Cyuan 2014-2017
 @license MIT
 Kirill, Fomichev 2014
 @license MIT
*/
(function(N,O){if("object"===typeof exports)"object"===typeof module?module.exports=O(require("js-sha256"),require("base64-js")):exports.keycloak=O(require("js-sha256"),require("base64-js"));else{!function(){function d(a,c){c?(x[0]=x[16]=x[1]=x[2]=x[3]=x[4]=x[5]=x[6]=x[7]=x[8]=x[9]=x[10]=x[11]=x[12]=x[13]=x[14]=x[15]=0,this.blocks=x):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];a?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=
1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225);this.block=this.start=this.bytes=this.hBytes=0;this.finalized=this.hashed=!1;this.first=!0;this.is224=a}function E(a,c,F){var e;e=typeof a;if("string"===e){var h,v=[],f=a.length,b=0;for(e=0;e<f;++e)128>(h=a.charCodeAt(e))?v[b++]=h:2048>h?(v[b++]=192|h>>6,v[b++]=128|63&h):55296>h||57344<=h?(v[b++]=224|h>>12,v[b++]=128|
h>>6&63,v[b++]=128|63&h):(h=65536+((1023&h)<<10|1023&a.charCodeAt(++e)),v[b++]=240|h>>18,v[b++]=128|h>>12&63,v[b++]=128|h>>6&63,v[b++]=128|63&h);a=v}else{if("object"!==e)throw Error(q);if(null===a)throw Error(q);if(H&&a.constructor===ArrayBuffer)a=new Uint8Array(a);else if(!(Array.isArray(a)||H&&ArrayBuffer.isView(a)))throw Error(q);}64<a.length&&(a=(new d(c,!0)).update(a).array());h=[];v=[];for(e=0;64>e;++e)f=a[e]||0,h[e]=92^f,v[e]=54^f;d.call(this,c,F);this.update(v);this.oKeyPad=h;this.inner=!0;
this.sharedMemory=F}var q="input is invalid type",A="object"==typeof window,w=A?window:{};w.JS_SHA256_NO_WINDOW&&(A=!1);var A=!A&&"object"==typeof self,y=!w.JS_SHA256_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node;y?w=global:A&&(w=self);var A=!w.JS_SHA256_NO_COMMON_JS&&"object"==typeof module&&module.exports,n="function"==typeof define&&define.amd,H=!w.JS_SHA256_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,c="0123456789abcdef".split(""),t=[-2147483648,8388608,32768,
128],g=[24,16,8,0],K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,
3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],L=["hex","array","digest","arrayBuffer"],x=[];!w.JS_SHA256_NO_NODE_JS&&Array.isArray||(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)});!H||!w.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(a){return"object"==typeof a&&a.buffer&&
a.buffer.constructor===ArrayBuffer});var M=function(a,c){return function(e){return(new d(c,!0)).update(e)[a]()}},J=function(a){var c=M("hex",a);y&&(c=I(c,a));c.create=function(){return new d(a)};c.update=function(a){return c.create().update(a)};for(var e=0;e<L.length;++e){var p=L[e];c[p]=M(p,a)}return c},I=function(a,c){var e=eval("require('crypto')"),h=eval("require('buffer').Buffer"),r=c?"sha224":"sha256";return function(c){if("string"==typeof c)return e.createHash(r).update(c,"utf8").digest("hex");
if(null===c||void 0===c)throw Error(q);return c.constructor===ArrayBuffer&&(c=new Uint8Array(c)),Array.isArray(c)||ArrayBuffer.isView(c)||c.constructor===h?e.createHash(r).update(new h(c)).digest("hex"):a(c)}},a=function(a,c){return function(e,h){return(new E(e,c,!0)).update(h)[a]()}},G=function(c){var e=a("hex",c);e.create=function(a){return new E(a,c)};e.update=function(a,c){return e.create(a).update(c)};for(var F=0;F<L.length;++F){var p=L[F];e[p]=a(p,c)}return e};d.prototype.update=function(a){if(!this.finalized){var c,
e=typeof a;if("string"!==e){if("object"!==e)throw Error(q);if(null===a)throw Error(q);if(H&&a.constructor===ArrayBuffer)a=new Uint8Array(a);else if(!(Array.isArray(a)||H&&ArrayBuffer.isView(a)))throw Error(q);c=!0}for(var p,r=0,d=a.length,f=this.blocks;r<d;){if(this.hashed&&(this.hashed=!1,f[0]=this.block,f[16]=f[1]=f[2]=f[3]=f[4]=f[5]=f[6]=f[7]=f[8]=f[9]=f[10]=f[11]=f[12]=f[13]=f[14]=f[15]=0),c)for(e=this.start;r<d&&64>e;++r)f[e>>2]|=a[r]<<g[3&e++];else for(e=this.start;r<d&&64>e;++r)128>(p=a.charCodeAt(r))?
f[e>>2]|=p<<g[3&e++]:2048>p?(f[e>>2]|=(192|p>>6)<<g[3&e++],f[e>>2]|=(128|63&p)<<g[3&e++]):55296>p||57344<=p?(f[e>>2]|=(224|p>>12)<<g[3&e++],f[e>>2]|=(128|p>>6&63)<<g[3&e++],f[e>>2]|=(128|63&p)<<g[3&e++]):(p=65536+((1023&p)<<10|1023&a.charCodeAt(++r)),f[e>>2]|=(240|p>>18)<<g[3&e++],f[e>>2]|=(128|p>>12&63)<<g[3&e++],f[e>>2]|=(128|p>>6&63)<<g[3&e++],f[e>>2]|=(128|63&p)<<g[3&e++]);this.lastByteIndex=e;this.bytes+=e-this.start;64<=e?(this.block=f[16],this.start=e-64,this.hash(),this.hashed=!0):this.start=
e}return 4294967295<this.bytes&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes%=4294967296),this}};d.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var a=this.blocks,c=this.lastByteIndex;a[16]=this.block;a[c>>2]|=t[3&c];this.block=a[16];56<=c&&(this.hashed||this.hash(),a[0]=this.block,a[16]=a[1]=a[2]=a[3]=a[4]=a[5]=a[6]=a[7]=a[8]=a[9]=a[10]=a[11]=a[12]=a[13]=a[14]=a[15]=0);a[14]=this.hBytes<<3|this.bytes>>>29;a[15]=this.bytes<<3;this.hash()}};d.prototype.hash=function(){var a,
c,d,p,r,g,f,b=this.h0,m=this.h1,z=this.h2,l=this.h3,u=this.h4,k=this.h5,B=this.h6,D=this.h7,t=this.blocks;for(a=16;64>a;++a)c=((r=t[a-15])>>>7|r<<25)^(r>>>18|r<<14)^r>>>3,d=((r=t[a-2])>>>17|r<<15)^(r>>>19|r<<13)^r>>>10,t[a]=t[a-16]+c+t[a-7]+d<<0;f=m&z;for(a=0;64>a;a+=4)this.first?(this.is224?(g=300032,D=(r=t[0]-1413257819)-150054599<<0,l=r+24177077<<0):(g=704751109,D=(r=t[0]-210244248)-1521486534<<0,l=r+143694565<<0),this.first=!1):(c=(b>>>2|b<<30)^(b>>>13|b<<19)^(b>>>22|b<<10),p=(g=b&m)^b&z^f,D=
l+(r=D+((u>>>6|u<<26)^(u>>>11|u<<21)^(u>>>25|u<<7))+(u&k^~u&B)+K[a]+t[a])<<0,l=r+(c+p)<<0),c=(l>>>2|l<<30)^(l>>>13|l<<19)^(l>>>22|l<<10),p=(f=l&b)^l&m^g,B=z+(r=B+((D>>>6|D<<26)^(D>>>11|D<<21)^(D>>>25|D<<7))+(D&u^~D&k)+K[a+1]+t[a+1])<<0,c=((z=r+(c+p)<<0)>>>2|z<<30)^(z>>>13|z<<19)^(z>>>22|z<<10),p=(d=z&l)^z&b^f,k=m+(r=k+((B>>>6|B<<26)^(B>>>11|B<<21)^(B>>>25|B<<7))+(B&D^~B&u)+K[a+2]+t[a+2])<<0,c=((m=r+(c+p)<<0)>>>2|m<<30)^(m>>>13|m<<19)^(m>>>22|m<<10),p=(f=m&z)^m&l^d,u=b+(r=u+((k>>>6|k<<26)^(k>>>11|
k<<21)^(k>>>25|k<<7))+(k&B^~k&D)+K[a+3]+t[a+3])<<0,b=r+(c+p)<<0;this.h0=this.h0+b<<0;this.h1=this.h1+m<<0;this.h2=this.h2+z<<0;this.h3=this.h3+l<<0;this.h4=this.h4+u<<0;this.h5=this.h5+k<<0;this.h6=this.h6+B<<0;this.h7=this.h7+D<<0};d.prototype.hex=function(){this.finalize();var a=this.h0,h=this.h1,d=this.h2,t=this.h3,g=this.h4,v=this.h5,f=this.h6,b=this.h7,a=c[a>>28&15]+c[a>>24&15]+c[a>>20&15]+c[a>>16&15]+c[a>>12&15]+c[a>>8&15]+c[a>>4&15]+c[15&a]+c[h>>28&15]+c[h>>24&15]+c[h>>20&15]+c[h>>16&15]+c[h>>
12&15]+c[h>>8&15]+c[h>>4&15]+c[15&h]+c[d>>28&15]+c[d>>24&15]+c[d>>20&15]+c[d>>16&15]+c[d>>12&15]+c[d>>8&15]+c[d>>4&15]+c[15&d]+c[t>>28&15]+c[t>>24&15]+c[t>>20&15]+c[t>>16&15]+c[t>>12&15]+c[t>>8&15]+c[t>>4&15]+c[15&t]+c[g>>28&15]+c[g>>24&15]+c[g>>20&15]+c[g>>16&15]+c[g>>12&15]+c[g>>8&15]+c[g>>4&15]+c[15&g]+c[v>>28&15]+c[v>>24&15]+c[v>>20&15]+c[v>>16&15]+c[v>>12&15]+c[v>>8&15]+c[v>>4&15]+c[15&v]+c[f>>28&15]+c[f>>24&15]+c[f>>20&15]+c[f>>16&15]+c[f>>12&15]+c[f>>8&15]+c[f>>4&15]+c[15&f];return this.is224||
(a+=c[b>>28&15]+c[b>>24&15]+c[b>>20&15]+c[b>>16&15]+c[b>>12&15]+c[b>>8&15]+c[b>>4&15]+c[15&b]),a};d.prototype.toString=d.prototype.hex;d.prototype.digest=function(){this.finalize();var a=this.h0,c=this.h1,d=this.h2,t=this.h3,g=this.h4,v=this.h5,f=this.h6,b=this.h7,a=[a>>24&255,a>>16&255,a>>8&255,255&a,c>>24&255,c>>16&255,c>>8&255,255&c,d>>24&255,d>>16&255,d>>8&255,255&d,t>>24&255,t>>16&255,t>>8&255,255&t,g>>24&255,g>>16&255,g>>8&255,255&g,v>>24&255,v>>16&255,v>>8&255,255&v,f>>24&255,f>>16&255,f>>
8&255,255&f];return this.is224||a.push(b>>24&255,b>>16&255,b>>8&255,255&b),a};d.prototype.array=d.prototype.digest;d.prototype.arrayBuffer=function(){this.finalize();var a=new ArrayBuffer(this.is224?28:32),c=new DataView(a);return c.setUint32(0,this.h0),c.setUint32(4,this.h1),c.setUint32(8,this.h2),c.setUint32(12,this.h3),c.setUint32(16,this.h4),c.setUint32(20,this.h5),c.setUint32(24,this.h6),this.is224||c.setUint32(28,this.h7),a};E.prototype=new d;E.prototype.finalize=function(){if(d.prototype.finalize.call(this),
this.inner){this.inner=!1;var a=this.array();d.call(this,this.is224,this.sharedMemory);this.update(this.oKeyPad);this.update(a);d.prototype.finalize.call(this)}};var C=J();C.sha256=C;C.sha224=J(!0);C.sha256.hmac=G();C.sha224.hmac=G(!0);A?module.exports=C:(w.sha256=C.sha256,w.sha224=C.sha224,n&&define(function(){return C}))}();(function(d){"object"===typeof exports&&"undefined"!==typeof module?module.exports=d():"function"===typeof define&&define.amd?define([],d):("undefined"!==typeof window?window:
"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).base64js=d()})(function(){return function(){function d(E,q,A){function w(n,c){if(!q[n]){if(!E[n]){var t="function"==typeof require&&require;if(!c&&t)return t(n,!0);if(y)return y(n,!0);c=Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c;}c=q[n]={exports:{}};E[n][0].call(c.exports,function(c){return w(E[n][1][c]||c)},c,c.exports,d,E,q,A)}return q[n].exports}for(var y="function"==typeof require&&require,n=0;n<
A.length;n++)w(A[n]);return w}return d}()({"/":[function(d,E,q){function A(c){var d=c.length;if(0<d%4)throw Error("Invalid string. Length must be a multiple of 4");c=c.indexOf("\x3d");-1===c&&(c=d);return[c,c===d?0:4-c%4]}function w(c,d,g){for(var t=[],n=d;n<g;n+=3)d=(c[n]<<16&16711680)+(c[n+1]<<8&65280)+(c[n+2]&255),t.push(y[d>>18&63]+y[d>>12&63]+y[d>>6&63]+y[d&63]);return t.join("")}q.byteLength=function(c){c=A(c);var d=c[1];return 3*(c[0]+d)/4-d};q.toByteArray=function(c){var d,g=A(c);d=g[0];for(var g=
g[1],q=new H(3*(d+g)/4-g),y=0,x=0<g?d-4:d,w=0;w<x;w+=4)d=n[c.charCodeAt(w)]<<18|n[c.charCodeAt(w+1)]<<12|n[c.charCodeAt(w+2)]<<6|n[c.charCodeAt(w+3)],q[y++]=d>>16&255,q[y++]=d>>8&255,q[y++]=d&255;2===g&&(d=n[c.charCodeAt(w)]<<2|n[c.charCodeAt(w+1)]>>4,q[y++]=d&255);1===g&&(d=n[c.charCodeAt(w)]<<10|n[c.charCodeAt(w+1)]<<4|n[c.charCodeAt(w+2)]>>2,q[y++]=d>>8&255,q[y++]=d&255);return q};q.fromByteArray=function(c){for(var d=c.length,g=d%3,n=[],q=0,x=d-g;q<x;q+=16383)n.push(w(c,q,q+16383>x?x:q+16383));
1===g?(c=c[d-1],n.push(y[c>>2]+y[c<<4&63]+"\x3d\x3d")):2===g&&(c=(c[d-2]<<8)+c[d-1],n.push(y[c>>10]+y[c>>4&63]+y[c<<2&63]+"\x3d"));return n.join("")};var y=[],n=[],H="undefined"!==typeof Uint8Array?Uint8Array:Array;for(d=0;64>d;++d)y[d]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[d],n["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(d)]=d;n[45]=62;n[95]=63},{}]},{},[])("/")});var I=O(N.sha256,N.base64js);N.Keycloak=I;"function"===typeof define&&
define.amd&&define("keycloak",[],function(){return I})}})(window,function(N,O){function I(d){function E(a,c){var b;var m=window.crypto||window.msCrypto;if(m&&m.getRandomValues&&window.Uint8Array)b=new Uint8Array(a),m.getRandomValues(b);else for(b=Array(a),m=0;m<b.length;m++)b[m]=Math.floor(256*Math.random());for(var m=Array(a),d=0;d<a;d++)m[d]=c.charCodeAt(b[d]%c.length);return String.fromCharCode.apply(null,m)}function q(){if("undefined"!==typeof a.authServerUrl)return"/"==a.authServerUrl.charAt(a.authServerUrl.length-
1)?a.authServerUrl+"realms/"+encodeURIComponent(a.realm):a.authServerUrl+"/realms/"+encodeURIComponent(a.realm)}function A(b,c){function m(m,k,d,l){B=(B+(new Date).getTime())/2;y(m,k,d,B);r&&(a.tokenParsed&&a.tokenParsed.nonce!=b.storedNonce||a.refreshTokenParsed&&a.refreshTokenParsed.nonce!=b.storedNonce||a.idTokenParsed&&a.idTokenParsed.nonce!=b.storedNonce)?(console.info("[KEYCLOAK] Invalid nonce, clearing token"),a.clearToken(),c&&c.setError()):l&&(a.onAuthSuccess&&a.onAuthSuccess(),c&&c.setSuccess())}
var d=b.code,u=b.error,k=b.prompt,B=(new Date).getTime();if(u)"none"!=k?(d={error:u,error_description:b.error_description},a.onAuthError&&a.onAuthError(d),c&&c.setError(d)):c&&c.setSuccess();else if("standard"!=a.flow&&(b.access_token||b.id_token)&&m(b.access_token,null,b.id_token,!0),"implicit"!=a.flow&&d){var d="code\x3d"+d+"\x26grant_type\x3dauthorization_code",u=a.endpoints.token(),e=new XMLHttpRequest;e.open("POST",u,!0);e.setRequestHeader("Content-type","application/x-www-form-urlencoded");
a.clientId&&a.clientSecret?e.setRequestHeader("Authorization","Basic "+btoa(a.clientId+":"+a.clientSecret)):d+="\x26client_id\x3d"+encodeURIComponent(a.clientId);d+="\x26redirect_uri\x3d"+b.redirectUri;b.pkceCodeVerifier&&(d+="\x26code_verifier\x3d"+b.pkceCodeVerifier);e.withCredentials=!0;e.onreadystatechange=function(){if(4==e.readyState)if(200==e.status){var b=JSON.parse(e.responseText);m(b.access_token,b.refresh_token,b.id_token,"standard"===a.flow);M()}else a.onAuthError&&a.onAuthError(),c&&
c.setError()};e.send(d)}}function w(b){function c(b){a.endpoints=b?{authorize:function(){return b.authorization_endpoint},token:function(){return b.token_endpoint},logout:function(){if(!b.end_session_endpoint)throw"Not supported by the OIDC server";return b.end_session_endpoint},checkSessionIframe:function(){if(!b.check_session_iframe)throw"Not supported by the OIDC server";return b.check_session_iframe},register:function(){throw'Redirection to "Register user" page not supported in standard OIDC mode';
},userinfo:function(){if(!b.userinfo_endpoint)throw"Not supported by the OIDC server";return b.userinfo_endpoint}}:{authorize:function(){return q()+"/protocol/openid-connect/auth"},token:function(){return q()+"/protocol/openid-connect/token"},logout:function(){return q()+"/protocol/openid-connect/logout"},checkSessionIframe:function(){var b=q()+"/protocol/openid-connect/login-status-iframe.html";a.iframeVersion&&(b=b+"?version\x3d"+a.iframeVersion);return b},register:function(){return q()+"/protocol/openid-connect/registrations"},
userinfo:function(){return q()+"/protocol/openid-connect/userinfo"}}}var z=g(!0),l;d?"string"===typeof d&&(l=d):l="keycloak.json";if(l){var e=new XMLHttpRequest;e.open("GET",l,!0);e.setRequestHeader("Accept","application/json");e.onreadystatechange=function(){if(4==e.readyState)if(200==e.status||0==e.status&&e.responseText&&e.responseURL.startsWith("file:")){var b=JSON.parse(e.responseText);a.authServerUrl=b["auth-server-url"];a.realm=b.realm;a.clientId=b.resource;a.clientSecret=(b.credentials||{}).secret;
c(null);z.setSuccess()}else z.setError()};e.send()}else{if(!d.clientId)throw"clientId missing";a.clientId=d.clientId;a.clientSecret=(d.credentials||{}).secret;if(b=d.oidcProvider)"string"===typeof b?(b="/"==b.charAt(b.length-1)?b+".well-known/openid-configuration":b+"/.well-known/openid-configuration",e=new XMLHttpRequest,e.open("GET",b,!0),e.setRequestHeader("Accept","application/json"),e.onreadystatechange=function(){if(4==e.readyState)if(200==e.status||0==e.status&&e.responseText&&e.responseURL.startsWith("file:")){var a=
JSON.parse(e.responseText);c(a);z.setSuccess()}else z.setError()},e.send()):(c(b),z.setSuccess());else{if(!d.url)for(b=document.getElementsByTagName("script"),l=0;l<b.length;l++)if(b[l].src.match(/.*keycloak\.js/)){d.url=b[l].src.substr(0,b[l].src.indexOf("/js/keycloak.js"));break}if(!d.realm)throw"realm missing";a.authServerUrl=d.url;a.realm=d.realm;c(null);z.setSuccess()}}return z.promise}function y(b,c,d,e){a.tokenTimeoutHandle&&(clearTimeout(a.tokenTimeoutHandle),a.tokenTimeoutHandle=null);c?
(a.refreshToken=c,a.refreshTokenParsed=n(c)):(delete a.refreshToken,delete a.refreshTokenParsed);d?(a.idToken=d,a.idTokenParsed=n(d)):(delete a.idToken,delete a.idTokenParsed);if(b){if(a.token=b,a.tokenParsed=n(b),a.sessionId=a.tokenParsed.session_state,a.authenticated=!0,a.subject=a.tokenParsed.sub,a.realmAccess=a.tokenParsed.realm_access,a.resourceAccess=a.tokenParsed.resource_access,e&&(a.timeSkew=Math.floor(e/1E3)-a.tokenParsed.iat),null!=a.timeSkew&&(console.info("[KEYCLOAK] Estimated time difference between browser and server is "+
a.timeSkew+" seconds"),a.onTokenExpired))if(b=1E3*(a.tokenParsed.exp-(new Date).getTime()/1E3+a.timeSkew),console.info("[KEYCLOAK] Token expires in "+Math.round(b/1E3)+" s"),0>=b)a.onTokenExpired();else a.tokenTimeoutHandle=setTimeout(a.onTokenExpired,b)}else delete a.token,delete a.tokenParsed,delete a.subject,delete a.realmAccess,delete a.resourceAccess,a.authenticated=!1}function n(a){a=a.split(".")[1];a=a.replace("/-/g","+");a=a.replace("/_/g","/");switch(a.length%4){case 0:break;case 2:a+="\x3d\x3d";
break;case 3:a+="\x3d";break;default:throw"Invalid token";}a=(a+"\x3d\x3d\x3d").slice(0,a.length+a.length%4);a=a.replace(/-/g,"+").replace(/_/g,"/");a=decodeURIComponent(escape(atob(a)));return a=JSON.parse(a)}function H(){var a=E(36,"0123456789abcdef").split("");a[14]="4";a[19]="0123456789abcdef".substr(a[19]&3|8,1);a[8]=a[13]=a[18]=a[23]="-";return a.join("")}function c(b){a:{var c;switch(a.flow){case "standard":c=["code","state","session_state"];break;case "implicit":c="access_token token_type id_token state session_state expires_in".split(" ");
break;case "hybrid":c=["access_token","id_token","code","state","session_state"]}c.push("error");c.push("error_description");c.push("error_uri");var d=b.indexOf("?"),l=b.indexOf("#"),f,k;"query"===a.responseMode&&-1!==d?(f=b.substring(0,d),k=t(b.substring(d+1,-1!==l?l:b.length),c),""!==k.paramsString&&(f+="?"+k.paramsString),-1!==l&&(f+=b.substring(l))):"fragment"===a.responseMode&&-1!==l&&(f=b.substring(0,l),k=t(b.substring(l+1),c),""!==k.paramsString&&(f+="#"+k.paramsString));if(k&&k.oauthParams)if("standard"===
a.flow||"hybrid"===a.flow){if((k.oauthParams.code||k.oauthParams.error)&&k.oauthParams.state){k.oauthParams.newUrl=f;b=k.oauthParams;break a}}else if("implicit"===a.flow&&(k.oauthParams.access_token||k.oauthParams.error)&&k.oauthParams.state){k.oauthParams.newUrl=f;b=k.oauthParams;break a}b=void 0}if(b){if(c=e.get(b.state))b.valid=!0,b.redirectUri=c.redirectUri,b.storedNonce=c.nonce,b.prompt=c.prompt,b.pkceCodeVerifier=c.pkceCodeVerifier;return b}}function t(a,c){a=a.split("\x26");for(var b={paramsString:"",
oauthParams:{}},m=0;m<a.length;m++){var d=a[m].split("\x3d");-1!==c.indexOf(d[0])?b.oauthParams[d[0]]=d[1]:(""!==b.paramsString&&(b.paramsString+="\x26"),b.paramsString+=a[m])}return b}function g(b){return!b&&a.useNativePromise?K():L()}function K(){var a={setSuccess:function(b){a.resolve(b)},setError:function(b){a.reject(b)}};a.promise=new Promise(function(b,c){a.resolve=b;a.reject=c});return a}function L(){var a={setSuccess:function(b){a.success=!0;a.result=b;a.successCallback&&a.successCallback(b)},
setError:function(b){a.error=!0;a.result=b;a.errorCallback&&a.errorCallback(b)},promise:{success:function(b){a.success?b(a.result):a.error||(a.successCallback=b);return a.promise},error:function(b){a.error?b(a.result):a.success||(a.errorCallback=b);return a.promise}}};return a}function x(){var b=g(!0);if(!h.enable||h.iframe)return b.setSuccess(),b.promise;var c=document.createElement("iframe");h.iframe=c;c.onload=function(){var c=a.endpoints.authorize();"/"===c.charAt(0)?(c=window.location.origin?
window.location.origin:window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""),h.iframeOrigin=c):h.iframeOrigin=c.substring(0,c.indexOf("/",8));b.setSuccess()};var d=a.endpoints.checkSessionIframe();c.setAttribute("src",d);c.setAttribute("title","keycloak-session-iframe");c.style.display="none";document.body.appendChild(c);window.addEventListener("message",function(b){if(b.origin===h.iframeOrigin&&h.iframe.contentWindow===b.source&&("unchanged"==b.data||
"changed"==b.data||"error"==b.data)){"unchanged"!=b.data&&a.clearToken();for(var c=h.callbackList.splice(0,h.callbackList.length),k=c.length-1;0<=k;--k){var d=c[k];"error"==b.data?d.setError():d.setSuccess("unchanged"==b.data)}}},!1);return b.promise}function M(){h.enable&&a.token&&setTimeout(function(){J().success(function(a){a&&M()})},1E3*h.interval)}function J(){var b=g(!0);if(h.iframe&&h.iframeOrigin){var c=a.clientId+" "+(a.sessionId?a.sessionId:"");h.callbackList.push(b);var d=h.iframeOrigin;
1==h.callbackList.length&&h.iframe.contentWindow.postMessage(c,d)}else b.setSuccess();return b.promise}function P(b){if(!b||"default"==b)return{login:function(b){window.location.replace(a.createLoginUrl(b));return g().promise},logout:function(b){window.location.replace(a.createLogoutUrl(b));return g().promise},register:function(b){window.location.replace(a.createRegisterUrl(b));return g().promise},accountManagement:function(){var b=a.createAccountUrl();if("undefined"!==typeof b)window.location.href=
b;else throw"Not supported by the OIDC server";return g(!1).promise},redirectUri:function(b,c){1==arguments.length&&(c=!0);return b&&b.redirectUri?b.redirectUri:a.redirectUri?a.redirectUri:location.href}};if("cordova"==b){h.enable=!1;var d=function(a,b,c){return window.cordova&&window.cordova.InAppBrowser?window.cordova.InAppBrowser.open(a,b,c):window.open(a,b,c)},e=function(a){return a&&a.cordovaOptions?Object.keys(a.cordovaOptions).reduce(function(b,c){b[c]=a.cordovaOptions[c];return b},{}):{}},
f=function(a){return Object.keys(a).reduce(function(b,c){b.push(c+"\x3d"+a[c]);return b},[]).join(",")},u=function(a){var b=e(a);b.location="no";a&&"none"==a.prompt&&(b.hidden="yes");return f(b)};return{login:function(b){var e=g(!1),m=u(b);b=a.createLoginUrl(b);var k=d(b,"_blank",m),f=!1,l=!1;k.addEventListener("loadstart",function(a){0==a.url.indexOf("http://localhost")&&(a=c(a.url),A(a,e),l=!0,k.close(),f=!0)});k.addEventListener("loaderror",function(a){f||(0==a.url.indexOf("http://localhost")?
(a=c(a.url),A(a,e),l=!0,k.close(),f=!0):(e.setError(),l=!0,k.close()))});k.addEventListener("exit",function(a){l||e.setError({reason:"closed_by_user"})});return e.promise},logout:function(b){var c=g(!1);b=a.createLogoutUrl(b);var e=d(b,"_blank","location\x3dno,hidden\x3dyes"),m;e.addEventListener("loadstart",function(a){0==a.url.indexOf("http://localhost")&&e.close()});e.addEventListener("loaderror",function(a){0!=a.url.indexOf("http://localhost")&&(m=!0);e.close()});e.addEventListener("exit",function(b){m?
c.setError():(a.clearToken(),c.setSuccess())});return c.promise},register:function(b){var e=g(!1),m=a.createRegisterUrl();b=u(b);var k=d(m,"_blank",b);k.addEventListener("loadstart",function(a){0==a.url.indexOf("http://localhost")&&(k.close(),a=c(a.url),A(a,e))});return e.promise},accountManagement:function(){var b=a.createAccountUrl();if("undefined"!==typeof b){var c=d(b,"_blank","location\x3dno");c.addEventListener("loadstart",function(a){0==a.url.indexOf("http://localhost")&&c.close()})}else throw"Not supported by the OIDC server";
},redirectUri:function(a){return"http://localhost"}}}if("cordova-native"==b)return h.enable=!1,{login:function(b){var d=g(!1);b=a.createLoginUrl(b);universalLinks.subscribe("keycloak",function(a){universalLinks.unsubscribe("keycloak");window.cordova.plugins.browsertab.close();a=c(a.url);A(a,d)});window.cordova.plugins.browsertab.openUrl(b);return d.promise},logout:function(b){var c=g(!1);b=a.createLogoutUrl(b);universalLinks.subscribe("keycloak",function(b){universalLinks.unsubscribe("keycloak");
window.cordova.plugins.browsertab.close();a.clearToken();c.setSuccess()});window.cordova.plugins.browsertab.openUrl(b);return c.promise},register:function(b){var d=g(!1);b=a.createRegisterUrl(b);universalLinks.subscribe("keycloak",function(a){universalLinks.unsubscribe("keycloak");window.cordova.plugins.browsertab.close();a=c(a.url);A(a,d)});window.cordova.plugins.browsertab.openUrl(b);return d.promise},accountManagement:function(){var b=a.createAccountUrl();if("undefined"!==typeof b)window.cordova.plugins.browsertab.openUrl(b);
else throw"Not supported by the OIDC server";},redirectUri:function(b){return b&&b.redirectUri?b.redirectUri:a.redirectUri?a.redirectUri:"http://localhost"}};throw"invalid adapter type: "+b;}if(!(this instanceof I))return new I(d);for(var a=this,G,C=[],e,h={enable:!0,callbackList:[],interval:5},F=document.getElementsByTagName("script"),p=0;p<F.length;p++)-1===F[p].src.indexOf("keycloak.js")&&-1===F[p].src.indexOf("keycloak.min.js")||-1===F[p].src.indexOf("version\x3d")||(a.iframeVersion=F[p].src.substring(F[p].src.indexOf("version\x3d")+
8).split("\x26")[0]);var r=!0;a.init=function(b){function m(){var c=function(b){b||(d.prompt="none");a.login(d).success(function(){u.setSuccess()}).error(function(){u.setError()})},d={};switch(b.onLoad){case "check-sso":h.enable?x().success(function(){J().success(function(a){a?u.setSuccess():c(!1)}).error(function(){u.setError()})}):c(!1);break;case "login-required":c(!0);break;default:throw"Invalid value for onLoad";}}a.authenticated=!1;a:{try{e=new v;break a}catch(k){}e=new f}var z=["default","cordova",
"cordova-native"];G=b&&-1<z.indexOf(b.adapter)?P(b.adapter):b&&"object"===typeof b.adapter?b.adapter:window.Cordova||window.cordova?P("cordova"):P();if(b){"undefined"!==typeof b.useNonce&&(r=b.useNonce);"undefined"!==typeof b.checkLoginIframe&&(h.enable=b.checkLoginIframe);b.checkLoginIframeInterval&&(h.interval=b.checkLoginIframeInterval);a.useNativePromise="native"===b.promiseType?"function"===typeof Promise:!1;"login-required"===b.onLoad&&(a.loginRequired=!0);if(b.responseMode)if("query"===b.responseMode||
"fragment"===b.responseMode)a.responseMode=b.responseMode;else throw"Invalid value for responseMode";if(b.flow){switch(b.flow){case "standard":a.responseType="code";break;case "implicit":a.responseType="id_token token";break;case "hybrid":a.responseType="code id_token token";break;default:throw"Invalid value for flow";}a.flow=b.flow}null!=b.timeSkew&&(a.timeSkew=b.timeSkew);b.redirectUri&&(a.redirectUri=b.redirectUri);if(b.pkceMethod){if("S256"!==b.pkceMethod)throw"Invalid value for pkceMethod";a.pkceMethod=
b.pkceMethod}}a.responseMode||(a.responseMode="fragment");a.responseType||(a.responseType="code",a.flow="standard");var l=g(!1),u=g(!0);u.promise.success(function(){a.onReady&&a.onReady(a.authenticated);l.setSuccess(a.authenticated)}).error(function(a){l.setError(a)});z=w(d);z.success(function(){var d=c(window.location.href);d&&window.history.replaceState(window.history.state,null,d.newUrl);if(d&&d.valid)return x().success(function(){A(d,u)}).error(function(a){u.setError()});b?b.token&&b.refreshToken?
(y(b.token,b.refreshToken,b.idToken),h.enable?x().success(function(){J().success(function(b){b?(a.onAuthSuccess&&a.onAuthSuccess(),u.setSuccess(),M()):u.setSuccess()}).error(function(){u.setError()})}):a.updateToken(-1).success(function(){a.onAuthSuccess&&a.onAuthSuccess();u.setSuccess()}).error(function(){a.onAuthError&&a.onAuthError();b.onLoad?m():u.setError()})):b.onLoad?m():u.setSuccess():u.setSuccess()});z.error(function(){l.setError()});return l.promise};a.login=function(a){return G.login(a)};
a.createLoginUrl=function(b){var c=H(),d=H(),f=G.redirectUri(b),g={state:c,nonce:d,redirectUri:encodeURIComponent(f)};b&&b.prompt&&(g.prompt=b.prompt);var k;k=b&&"register"==b.action?a.endpoints.register():a.endpoints.authorize();var h;h=b&&b.scope?-1!=b.scope.indexOf("openid")?b.scope:"openid "+b.scope:"openid";c=k+"?client_id\x3d"+encodeURIComponent(a.clientId)+"\x26redirect_uri\x3d"+encodeURIComponent(f)+"\x26state\x3d"+encodeURIComponent(c)+"\x26response_mode\x3d"+encodeURIComponent(a.responseMode)+
"\x26response_type\x3d"+encodeURIComponent(a.responseType)+"\x26scope\x3d"+encodeURIComponent(h);r&&(c=c+"\x26nonce\x3d"+encodeURIComponent(d));b&&b.prompt&&(c+="\x26prompt\x3d"+encodeURIComponent(b.prompt));b&&b.maxAge&&(c+="\x26max_age\x3d"+encodeURIComponent(b.maxAge));b&&b.loginHint&&(c+="\x26login_hint\x3d"+encodeURIComponent(b.loginHint));b&&b.idpHint&&(c+="\x26kc_idp_hint\x3d"+encodeURIComponent(b.idpHint));b&&b.locale&&(c+="\x26ui_locales\x3d"+encodeURIComponent(b.locale));b&&b.kcLocale&&
(c+="\x26kc_locale\x3d"+encodeURIComponent(b.kcLocale));if(a.pkceMethod){b=E(96,"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789");g.pkceCodeVerifier=b;a:switch(a.pkceMethod){case "S256":b=new Uint8Array(N.arrayBuffer(b));b=O.fromByteArray(b).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"");break a;default:throw"Invalid value for pkceMethod";}c=c+("\x26code_challenge\x3d"+b)+("\x26code_challenge_method\x3d"+a.pkceMethod)}e.add(g);return c};a.logout=function(a){return G.logout(a)};
a.createLogoutUrl=function(b){return a.endpoints.logout()+"?redirect_uri\x3d"+encodeURIComponent(G.redirectUri(b,!1))};a.register=function(a){return G.register(a)};a.createRegisterUrl=function(b){b||(b={});b.action="register";return a.createLoginUrl(b)};a.createAccountUrl=function(b){var c=q(),d=void 0;"undefined"!==typeof c&&(d=c+"/account?referrer\x3d"+encodeURIComponent(a.clientId)+"\x26referrer_uri\x3d"+encodeURIComponent(G.redirectUri(b)));return d};a.accountManagement=function(){return G.accountManagement()};
a.hasRealmRole=function(b){var c=a.realmAccess;return!!c&&0<=c.roles.indexOf(b)};a.hasResourceRole=function(b,c){if(!a.resourceAccess)return!1;c=a.resourceAccess[c||a.clientId];return!!c&&0<=c.roles.indexOf(b)};a.loadUserProfile=function(){var b=q()+"/account",c=new XMLHttpRequest;c.open("GET",b,!0);c.setRequestHeader("Accept","application/json");c.setRequestHeader("Authorization","bearer "+a.token);var d=g(!1);c.onreadystatechange=function(){4==c.readyState&&(200==c.status?(a.profile=JSON.parse(c.responseText),
d.setSuccess(a.profile)):d.setError())};c.send();return d.promise};a.loadUserInfo=function(){var b=a.endpoints.userinfo(),c=new XMLHttpRequest;c.open("GET",b,!0);c.setRequestHeader("Accept","application/json");c.setRequestHeader("Authorization","bearer "+a.token);var d=g(!1);c.onreadystatechange=function(){4==c.readyState&&(200==c.status?(a.userInfo=JSON.parse(c.responseText),d.setSuccess(a.userInfo)):d.setError())};c.send();return d.promise};a.isTokenExpired=function(b){if(!a.tokenParsed||!a.refreshToken&&
"implicit"!=a.flow)throw"Not authenticated";if(null==a.timeSkew)return console.info("[KEYCLOAK] Unable to determine if token is expired as timeskew is not set"),!0;var c=a.tokenParsed.exp-Math.ceil((new Date).getTime()/1E3)+a.timeSkew;if(b){if(isNaN(b))throw"Invalid minValidity";c-=b}return 0>c};a.updateToken=function(b){var c=g(!1);if(!a.refreshToken)return c.setError(),c.promise;b=b||5;var d=function(){var d=!1;if(-1==b)d=!0,console.info("[KEYCLOAK] Refreshing token: forced refresh");else if(!a.tokenParsed||
a.isTokenExpired(b))d=!0,console.info("[KEYCLOAK] Refreshing token: token expired");if(d){var d="grant_type\x3drefresh_token\x26refresh_token\x3d"+a.refreshToken,e=a.endpoints.token();C.push(c);if(1==C.length){var f=new XMLHttpRequest;f.open("POST",e,!0);f.setRequestHeader("Content-type","application/x-www-form-urlencoded");f.withCredentials=!0;a.clientId&&a.clientSecret?f.setRequestHeader("Authorization","Basic "+btoa(a.clientId+":"+a.clientSecret)):d+="\x26client_id\x3d"+encodeURIComponent(a.clientId);
var g=(new Date).getTime();f.onreadystatechange=function(){if(4==f.readyState)if(200==f.status){console.info("[KEYCLOAK] Token refreshed");g=(g+(new Date).getTime())/2;var b=JSON.parse(f.responseText);y(b.access_token,b.refresh_token,b.id_token,g);a.onAuthRefreshSuccess&&a.onAuthRefreshSuccess();for(b=C.pop();null!=b;b=C.pop())b.setSuccess(!0)}else for(console.warn("[KEYCLOAK] Failed to refresh token"),400==f.status&&a.clearToken(),a.onAuthRefreshError&&a.onAuthRefreshError(),b=C.pop();null!=b;b=
C.pop())b.setError(!0)};f.send(d)}}else c.setSuccess(!1)};h.enable?J().success(function(){d()}).error(function(){c.setError()}):d();return c.promise};a.clearToken=function(){a.token&&(y(null,null,null),a.onAuthLogout&&a.onAuthLogout(),a.loginRequired&&a.login())};a.callback_id=0;var v=function(){function a(){for(var a=(new Date).getTime(),b=0;b<localStorage.length;b++){var c=localStorage.key(b);if(c&&0==c.indexOf("kc-callback-")){var d=localStorage.getItem(c);if(d)try{var e=JSON.parse(d).expires;
(!e||e<a)&&localStorage.removeItem(c)}catch(B){localStorage.removeItem(c)}}}}if(!(this instanceof v))return new v;localStorage.setItem("kc-test","test");localStorage.removeItem("kc-test");this.get=function(b){if(b){b="kc-callback-"+b;var c=localStorage.getItem(b);c&&(localStorage.removeItem(b),c=JSON.parse(c));a();return c}};this.add=function(b){a();var c="kc-callback-"+b.state;b.expires=(new Date).getTime()+36E5;localStorage.setItem(c,JSON.stringify(b))}},f=function(){if(!(this instanceof f))return new f;
this.get=function(b){if(b){var d;a:{d="kc-callback-"+b+"\x3d";for(var e=document.cookie.split(";"),f=0;f<e.length;f++){for(var g=e[f];" "==g.charAt(0);)g=g.substring(1);if(0==g.indexOf(d)){d=g.substring(d.length,g.length);break a}}d=""}c("kc-callback-"+b,"",a(-100));if(d)return JSON.parse(d)}};this.add=function(b){c("kc-callback-"+b.state,JSON.stringify(b),a(60))};this.removeItem=function(b){c(b,"",a(-100))};var a=function(a){var b=new Date;b.setTime(b.getTime()+6E4*a);return b},c=function(a,b,c){a=
a+"\x3d"+b+"; expires\x3d"+c.toUTCString()+"; ";document.cookie=a}}}return I});